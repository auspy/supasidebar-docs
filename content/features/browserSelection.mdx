# Browser Selection

Choose which browser opens your saved links - assign specific browsers per link, use your active browser dynamically, or pick on demand for ultimate flexibility.


## Purpose
Allow SupaSidebar users to control which browser opens a saved link. Provide simple, discoverable, and accessible ways to choose a browser **per link** or **one-time**, while keeping a sensible default behavior.

## Quick Start - Three Ways to Select a Browser

### **1. Rightâ€‘Click â†’ Open With**
- Rightâ€‘click on any link.
- Choose **"Open Withâ€¦"** from the context menu.
- Pick any installed browser.

### **2. Optionâ€‘Click on a Link**
- Hold **Option (âŒ¥)** and click a link.
- Supa Sidebar opens a browser selection popup.
- Choose the browser you want.

### **3. Option + Enter from Command Panel**
- Open the **Command Panel**.
- Select a link or command that involves opening a webpage.
- Press **Option + Enter (âŒ¥ + Return)**.
- Choose the browser from the popup.

> **Note:** The browser selection popup only appears when using shortcuts or modifier keys (Optionâ€‘Click, Optionâ€‘Enter). Your last used browser may be remembered depending on user settings. All three methods work for **links, tabs, and certain URLâ€‘related commands**.

---

## Scope
This feature covers: per-link browser assignment, one-time browser choice, keyboard-first flows, and a browser picker UI. It does **not** cover cross-device sync implementation details or low-level OS-level URL handling (those are separate tickets).

## Goals
- Make it easy for nonâ€‘technical users to pick a browser for each link.
- Support power users who prefer keyboard-only flows.
- Keep default behavior predictable (use assigned browser unless user overrides).
- Provide clear visual cues (browser badges) and accessible keyboard shortcuts.

## Key User Stories
- As a user, I want a link to always open in my chosen browser so my accounts stay separate.
- As a user, I want to open a link in a different browser just once without changing the default assignment.
- As a keyboard-first user, I want a shortcut to open the browser picker without touching the mouse.
- As a support agent, I want clear acceptance criteria so I can test internationalized and accessibility scenarios.

## How to Select a Browser (feature summary)
There are **three** ways to select which browser opens a link:

1. **Right-click â†’ "Open with" (Set / Change assignment)**
   - Persistent: sets the link's default browser assignment.
   - UI: context menu shows installed browsers; the selected browser becomes the link's assigned browser.

2. **Modifier key + Click / Enter â€” One-time choice**
   - One-time (temporary): Does not change the saved assignment.
   - Mouse: Hold **Option (âŒ¥)** and click the link â†’ Browser picker appears.
   - Keyboard: With a link selected, press **Option (âŒ¥) + Enter** â†’ Browser picker appears.

3. **Command panel / Quick Open â†’ Option + Enter**
   - Quick workflow for power users: open the command panel (âŒ˜âŒƒK), search for a link, press **âŒ¥Enter** to show the picker, then select browser with â†‘/â†“ + Return.

> Default behavior: If user does nothing, a link opens in its *assigned browser*. If no assignment exists, it opens in the system default browser.

## UX / UI
- **Browser badge** (small icon) appears next to saved links showing assigned browser.
- **Picker layout**: compact popover with installed browsers at top; disabled (grayed) items for unsupported / not installed browsers.
- **Placement**: picker appears adjacent to the clicked link or the cursor; keyboard-invoked picker appears near the selected item.
- **Help text**: first-time tooltip explaining `Option + click` and `Rightâ€‘click â†’ Open with`.

## Keyboard Shortcuts
- `âŒ¥ + Click` â€” open browser picker (mouse)
- `âŒ¥ + Enter` â€” open browser picker (keyboard when link selected)
- `âŒ˜ + âŒƒ + K` â€” open command panel
- `â†‘ / â†“` â€” navigate browser picker
- `Return` â€” select browser
- `Esc` â€” cancel picker

## Acceptance Criteria
1. **Per-link assignment**
   - Given a saved link, when I right-click and choose a browser, then that link shows the browser badge and opens in that browser by default.
2. **One-time selection**
   - Given a saved link with an existing assignment, when I hold Option and click the link and choose a different browser, then the link opens in the chosen browser but the assignment remains unchanged.
3. **Active browser mode** (preference)
   - Given "Use active browser" preference enabled, links open in the currently frontmost browser unless they have an explicit per-link assignment.
4. **Picker keyboard accessibility**
   - The picker must be reachable and operable using only keyboard (focus, arrow keys, Return, Esc). Screen reader announces available options.
5. **Unsupported / Not installed browsers**
   - If a browser is not found on the system, it must not be selectable and must appear disabled in the picker.
6. **Edge cases**
   - If the chosen browser fails to open, show a non-blocking error and fallback to the system default browser.

## Analytics / Telemetry
Track events (anonymized):
- `browser_assignment_changed` {link_id, new_browser}
- `browser_picker_opened` {link_id, via: 'option_click' | 'option_enter' | 'context_menu'}
- `browser_one_time_used` {link_id, browser}

## Accessibility
- Picker must have appropriate ARIA roles (menu, menuitem) and labels.
- Provide a text alternative describing the assigned browser for each link.
- Focus management: trap focus inside picker until closed; restore focus to the link on close.

## Internationalization
- All UI strings should be externalized for localization.

## Implementation Notes
- Use macOS `open -a` or equivalent cross-platform abstractions to open a URL with a specific app.
- Persist assignment in the link object: `link.browser_assignment = {id: 'chrome', name: 'Google Chrome'}`.
- UI should consult the installed browsers registry at startup and refresh on demand.

---


### Changing Browser Assignment

**For Single Link:**
1. Right-click the link in sidebar
2. Select **Set Browser**
3. Choose new browser
4. Assignment updated

**For Multiple Links:**
1. Select multiple links (â‡§â†‘/â†“)
2. Right-click selection
3. Select **Set Browser**
4. Choose browser
5. All selected links updated

### Removing Browser Assignment

**Reset to System Default:**
1. Right-click link
2. Select **Set Browser**
3. Choose **System Default**
4. Link uses macOS default browser

## One-Time Browser Selection

Choose a browser for a single use without changing assignment.

### Using Option Key + Click

**Method 1: Mouse**
1. Hold **âŒ¥** (Option)
2. Click link
3. Browser picker appears
4. Choose browser
5. Link opens, assignment unchanged

### Using Option Key + Return

**Method 2: Keyboard**
1. Navigate to link with â†‘â†“ keys
2. Press **âŒ¥Return**
3. Browser picker appears
4. Use â†‘â†“ to select browser
5. Press Return to open
6. Assignment unchanged

**Keyboard-Only Workflow:**
1. **âŒ˜âŒƒK** â†’ Open command panel
2. Type search query
3. **â†“** â†’ Select result
4. **âŒ¥Return** â†’ Browser picker
5. **â†“** â†’ Choose browser
6. **Return** â†’ Open

All without touching mouse.

## Browser Picker

### Available Browsers

The browser picker shows all installed supported browsers:

**Installed Browsers:**
- Shown at top of picker
- Includes icon and name
- Click or Return to select

**Not Installed:**
- Grayed out or not shown
- Install browser to enable

[PLACEHOLDER: Screenshot of browser picker showing installed vs not installed browsers]

### Picker Shortcuts

| Action | Shortcut |
|--------|----------|
| Show picker (mouse) | **âŒ¥Click** link |
| Show picker (keyboard) | **âŒ¥Return** on selected link |
| Navigate browsers | **â†‘** / **â†“** |
| Select browser | **Return** or **Click** |
| Cancel | **Esc** or click outside |

## Multi-Browser Workflows

### Dedicate Browsers to Contexts

**Professional Workflow:**
```
Work Space:
â”œâ”€â”€ Gmail (Chrome) - Work account
â”œâ”€â”€ Slack (Chrome) - Company workspace
â”œâ”€â”€ Jira (Chrome) - Project tracking
â””â”€â”€ Company Intranet (Chrome) - Corporate browser

Personal Space:
â”œâ”€â”€ Gmail (Safari) - Personal account
â”œâ”€â”€ Twitter (Safari) - Social media
â”œâ”€â”€ Shopping (Safari) - Personal browsing
â””â”€â”€ News (Safari) - Reading

Development Space:
â”œâ”€â”€ localhost:3000 (Firefox) - Dev server
â”œâ”€â”€ GitHub (Firefox) - Code repos
â”œâ”€â”€ Stack Overflow (Firefox) - Documentation
â””â”€â”€ MDN (Firefox) - Web docs
```

Each space uses dedicated browsers for context isolation.

[PLACEHOLDER: Screenshot showing different spaces with browser badges on links]

### Browser-Based Smart Folders

Automatically organize links by browser:

**Smart Folder: Chrome Work Links**
1. Create Smart Folder
2. Add condition: **Browser is "Chrome"**
3. All Chrome links collected automatically

**Smart Folder: Safari Personal**
1. Create Smart Folder
2. Add condition: **Browser is "Safari"**
3. All Safari links collected automatically

See [Smart Folders](smartFolders) for setup.

### Testing Workflow

Test same link across browsers:

**Method 1: One-Time Selection**
1. Open link with **âŒ¥Return**
2. Choose Chrome â†’ Test in Chrome
3. Open again with **âŒ¥Return**
4. Choose Firefox â†’ Test in Firefox
5. Open again with **âŒ¥Return**
6. Choose Safari â†’ Test in Safari

**Method 2: Active Browser Mode**
1. Enable "Use active browser" in Preferences
2. Switch to Chrome, click link â†’ Opens in Chrome
3. Switch to Firefox, click link â†’ Opens in Firefox
4. Switch to Safari, click link â†’ Opens in Safari

### Multi-Account Management

**Work vs Personal Accounts:**
- Gmail (Work) â†’ Chrome with work Google account
- Gmail (Personal) â†’ Safari with personal Google account
- Slack (Work) â†’ Chrome workspace
- Slack (Personal) â†’ Firefox workspace

Browser isolation prevents account conflicts.

### Browser-Specific Features

Some sites work better in specific browsers:

**Safari:** Best for Apple sites (iCloud, Apple Music, etc.)
**Chrome:** Best for Google services (Gmail, Drive, Meet)
**Arc:** Best for design tools with workspace features
**Firefox:** Best for privacy-focused browsing
**Edge:** Best for Microsoft 365 services

Assign links based on optimal browser performance.

### Supported Browsers

Window adjustment works with:
- Chrome
- Edge
- Brave
- Vivaldi
- Safari (limited)
- Other Chromium-based browsers

**Not Supported:**
- Firefox (window management API limitations)
- Arc (custom window behavior)
- Zen (Firefox-based)


## Preferences Configuration

### Link Opening Behavior

**Preferences â†’ General â†’ Link Opening Behavior**

**Options:**
1. **Use assigned browser** (Default)
   - Respects per-link browser settings
   - Consistent behavior
   - Recommended for most users

2. **Use active browser**
   - Opens in currently active browser
   - Dynamic behavior
   - Best for single-browser workflows


## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| **âŒ¥Click** | Show browser picker for clicked link |
| **âŒ¥Return** | Show browser picker for selected link |
| **â†‘** / **â†“** | Navigate browser picker |
| **Return** | Select browser in picker |
| **Esc** | Cancel browser picker |

See [Global Shortcuts](globalShortcuts) for complete reference.

## Tips & Tricks

### Browser Badges

Links in sidebar show small browser icons indicating assignment:
- Chrome icon â†’ Opens in Chrome
- Safari icon â†’ Opens in Safari
- No icon â†’ Uses system default

Visual indication of which browser will be used.

### Hover for Browser Info

Hover over a link to see:
- Full URL
- Assigned browser
- Last accessed time
- Other metadata

Quick browser assignment verification.

### Keyboard Navigation in Picker

Browser picker is fully keyboard accessible:
1. **âŒ¥Return** â†’ Open picker
2. **â†‘**/**â†“** â†’ Cycle browsers
3. **Return** â†’ Select
4. **Esc** â†’ Cancel

Never need mouse for browser selection.

### Test Multiple Browsers Fast

**Quick Testing Workflow:**
1. Select link in sidebar
2. **âŒ¥Return** â†’ Choose Chrome â†’ Test
3. **âŒ¥Return** again â†’ Choose Safari â†’ Test
4. **âŒ¥Return** again â†’ Choose Firefox â†’ Test
5. Repeat as needed

Fast cross-browser testing.

### Context Menus Remember Position

Browser picker appears near your cursor:
- Click top of sidebar â†’ Picker at top
- Click bottom â†’ Picker at bottom
- Optimized for quick mouse movement

### Organize by Browser Color

Use browser-themed folders:
- ðŸ”´ Chrome folder (red theme)
- ðŸ”µ Safari folder (blue theme)
- ðŸŸ  Firefox folder (orange theme)

Visual organization matching browser branding.

## Troubleshooting

### Browser Not in Picker

**Issue:** Expected browser doesn't appear in picker

**Solutions:**
1. Ensure browser is installed in Applications folder
2. Verify browser is supported (see [Browser Support](browserSupport))
3. Restart SupaSidebar
4. Check browser app name matches expected name

### Wrong Browser Opens

**Issue:** Link opens in unexpected browser

**Solutions:**
1. Check link's browser assignment (right-click â†’ check which browser is selected)
2. Verify Link Opening Behavior in Preferences â†’ General
3. If using "Active Browser" mode, ensure correct browser is frontmost
4. Right-click link â†’ Set Browser â†’ Choose correct browser

### Browser Picker Doesn't Appear

**Issue:** âŒ¥Click or âŒ¥Return doesn't show browser picker

**Solutions:**
1. Ensure Option key is held down while clicking/pressing Return
2. Check keyboard is working (test Option key in other apps)
3. Verify link is selected (for keyboard method)
4. Try mouse method if keyboard doesn't work
5. Restart SupaSidebar

### Window Adjustment Not Working

**Issue:** Browser window doesn't resize with sidebar

**Solutions:**
1. Check Preferences â†’ General â†’ Browser window adjustment is not "None"
2. Verify browser supports window adjustment (see supported browsers above)
3. Firefox and Arc don't support automatic adjustment
4. Try manual window resizing if automatic doesn't work

### Auto-Visibility Not Triggering

**Issue:** Sidebar doesn't appear when switching to browser

**Solutions:**
1. Check Preferences â†’ General â†’ "Show sidebar when browser is active" is enabled
2. Ensure browser has Automation permissions
3. Try clicking browser window to make it frontmost
4. Restart SupaSidebar

### Browser Assignment Not Saving

**Issue:** Browser selection doesn't persist

**Solutions:**
1. Ensure you're using "Set Browser" (right-click), not one-time selection (âŒ¥Click)
2. Check you're not in "Always ask" mode (Preferences â†’ General)
3. Verify link saves properly (delete and re-save if needed)
4. Check CloudKit sync status if using multiple devices

## Related Features

- [Browser Support](browserSupport) - Full list of 14 supported browsers
- [Smart Shortcuts](smartShortcuts) - Context-aware Save (âŒ˜âŒƒS) and Copy (âŒ˜âŒƒC)
- [Live Tabs](liveTabs) - Real-time tab tracking across browsers
- [Smart Folders](smartFolders) - Auto-organize links by browser
- [Spaces](spaces) - Create browser-specific workspaces
- [Global Shortcuts](globalShortcuts) - Complete keyboard reference
